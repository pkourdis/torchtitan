x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:15,689 - root - INFO - Starting job: Llama 3 8B training
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:15,690 - root - INFO - [GC] Initial GC collection. 0.00 seconds.
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:16,903 - root - INFO - Building 1-D device mesh with ['dp_shard'], [24]
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: 2025:03:19-08:50:16:(22329) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: 2025:03:19-08:50:16:(22329) |CCL_WARN| value of CCL_KVS_CONNECTION_TIMEOUT changed to be 140 (default:120)
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: 2025:03:19-08:50:16:(22329) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:19,449 - root - INFO - TikTokenizer built: #words 128256, BOS ID 128000, EOS ID 128001
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:19,449 - root - INFO - Preparing c4 dataset from /flare/Aurora_deployment/sgoswami/datavol/mldata/hf/c4
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:20,028 - root - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=8192, depth_init=True, norm_type='rmsnorm')
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:20,172 - root - INFO - XPU capacity: Intel(R) Data Center GPU Max 1550 with 64.00GiB memory
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:20,527 - root - WARNING - Peak flops undefined for: Intel(R) Data Center GPU Max 1550, fallback to A100
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:20,528 - root - INFO - [34mModel llama3 8B [31msize: 8,030,261,248 total parameters[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:20,528 - root - INFO - Applied selective activation checkpointing to the model
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:20,599 - root - INFO - Applied FSDP to the model
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:21,197 - root - WARNING - Peak flops undefined for: Intel(R) Data Center GPU Max 1550, fallback to A100
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:21,197 - root - INFO - Peak FLOPS used for computing MFU: 3.120e+14
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:21,197 - root - INFO - XPU memory usage for model: 1.40GiB(2.19%)
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:21,199 - root - INFO - Trainer initialized.
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:21,199 - root - INFO - Training starts at step 1, with local batch size 1, global batch size 24, sequence length 8192, total steps 1000 (warmup 200)
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:50,353 - root - INFO - [31mstep:  1  [32mloss: 12.2545  [33mmemory: 57.08GiB(89.18%)  [34mtps: 275  [36mtflops: 15.91  [35mmfu: 5.10%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:50:50,353 - root - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:01:40
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:54:05,317 - root - INFO - [31mstep: 10  [32mloss:  9.8138  [33mmemory: 57.49GiB(89.82%)  [34mtps: 378  [36mtflops: 21.90  [35mmfu: 7.02%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 08:57:41,607 - root - INFO - [31mstep: 20  [32mloss:  8.4222  [33mmemory: 57.49GiB(89.82%)  [34mtps: 379  [36mtflops: 21.94  [35mmfu: 7.03%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:01:17,975 - root - INFO - [31mstep: 30  [32mloss:  7.6070  [33mmemory: 57.49GiB(89.82%)  [34mtps: 379  [36mtflops: 21.93  [35mmfu: 7.03%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:04:54,525 - root - INFO - [31mstep: 40  [32mloss:  7.1875  [33mmemory: 57.49GiB(89.82%)  [34mtps: 378  [36mtflops: 21.91  [35mmfu: 7.02%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:08:09,591 - root - INFO - [GC] Peforming periodical GC collection. 0.07 seconds.
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:08:31,235 - root - INFO - [31mstep: 50  [32mloss:  7.0750  [33mmemory: 57.49GiB(89.82%)  [34mtps: 378  [36mtflops: 21.89  [35mmfu: 7.02%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:12:08,156 - root - INFO - [31mstep: 60  [32mloss:  6.8228  [33mmemory: 57.49GiB(89.82%)  [34mtps: 378  [36mtflops: 21.87  [35mmfu: 7.01%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:15:44,936 - root - INFO - [31mstep: 70  [32mloss:  6.5626  [33mmemory: 57.49GiB(89.82%)  [34mtps: 378  [36mtflops: 21.89  [35mmfu: 7.01%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:19:21,719 - root - INFO - [31mstep: 80  [32mloss:  6.5713  [33mmemory: 57.49GiB(89.82%)  [34mtps: 378  [36mtflops: 21.89  [35mmfu: 7.01%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:22:58,583 - root - INFO - [31mstep: 90  [32mloss:  6.4284  [33mmemory: 57.49GiB(89.82%)  [34mtps: 378  [36mtflops: 21.88  [35mmfu: 7.01%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:26:13,697 - root - INFO - [GC] Peforming periodical GC collection. 0.06 seconds.
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:26:35,357 - root - INFO - [31mstep: 100  [32mloss:  6.2997  [33mmemory: 57.49GiB(89.82%)  [34mtps: 378  [36mtflops: 21.89  [35mmfu: 7.01%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:30:13,937 - root - INFO - [31mstep: 110  [32mloss:  6.3022  [33mmemory: 57.49GiB(89.82%)  [34mtps: 375  [36mtflops: 21.71  [35mmfu: 6.96%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:33:50,627 - root - INFO - [31mstep: 120  [32mloss:  6.2353  [33mmemory: 57.49GiB(89.82%)  [34mtps: 378  [36mtflops: 21.89  [35mmfu: 7.02%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:37:27,409 - root - INFO - [31mstep: 130  [32mloss:  6.0737  [33mmemory: 57.49GiB(89.82%)  [34mtps: 378  [36mtflops: 21.89  [35mmfu: 7.01%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:41:04,098 - root - INFO - [31mstep: 140  [32mloss:  6.1761  [33mmemory: 57.49GiB(89.82%)  [34mtps: 378  [36mtflops: 21.89  [35mmfu: 7.02%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:44:19,251 - root - INFO - [GC] Peforming periodical GC collection. 0.06 seconds.
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:44:40,925 - root - INFO - [31mstep: 150  [32mloss:  6.0375  [33mmemory: 57.49GiB(89.82%)  [34mtps: 378  [36mtflops: 21.88  [35mmfu: 7.01%[39m
x4111c6s3b0n0.hostmgmt2111.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 09:48:17,600 - root - INFO - [31mstep: 160  [32mloss:  6.0394  [33mmemory: 57.49GiB(89.82%)  [34mtps: 378  [36mtflops: 21.90  [35mmfu: 7.02%[39m
