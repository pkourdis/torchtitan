x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:41:20,955 - root - INFO - Starting job: Llama 3 8B training
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:41:20,955 - root - INFO - [GC] Initial GC collection. 0.00 seconds.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:43:43,222 - root - INFO - Building 1-D device mesh with ['dp_shard'], [24]
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: 2025:03:19-16:43:43:(97570) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: 2025:03:19-16:43:43:(97570) |CCL_WARN| value of CCL_KVS_CONNECTION_TIMEOUT changed to be 140 (default:120)
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: 2025:03:19-16:43:43:(97570) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:43:48,665 - root - INFO - TikTokenizer built: #words 128256, BOS ID 128000, EOS ID 128001
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:43:48,665 - root - INFO - Preparing c4 dataset from /flare/Aurora_deployment/sgoswami/datavol/mldata/hf/c4
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:43:50,594 - root - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=8192, depth_init=True, norm_type='rmsnorm')
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:43:51,044 - root - INFO - XPU capacity: Intel(R) Data Center GPU Max 1550 with 64.00GiB memory
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:43:51,628 - root - WARNING - Peak flops undefined for: Intel(R) Data Center GPU Max 1550, fallback to A100
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:43:51,629 - root - INFO - [34mModel llama3 8B [31msize: 8,030,261,248 total parameters[39m
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:43:51,630 - root - INFO - Applied selective activation checkpointing to the model
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:43:51,993 - root - INFO - Applied FSDP to the model
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:43:54,917 - root - WARNING - Peak flops undefined for: Intel(R) Data Center GPU Max 1550, fallback to A100
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:43:54,917 - root - INFO - Peak FLOPS used for computing MFU: 3.120e+14
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:43:54,918 - root - INFO - XPU memory usage for model: 1.40GiB(2.19%)
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:43:54,919 - root - INFO - Trainer initialized.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:43:54,919 - root - INFO - Training starts at step 1, with local batch size 1, global batch size 24, sequence length 8192, total steps 1000 (warmup 200)
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:44:29,901 - root - INFO - [31mstep:  1  [32mloss: 12.2309  [33mmemory: 57.08GiB(89.18%)  [34mtps: 214  [36mtflops: 12.40  [35mmfu: 3.97%[39m
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:44:29,902 - root - INFO - Synchronizing and adjusting timeout for all ProcessGroups to 0:01:40
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 17: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 17:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 12: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 12:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 13: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 13:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 14: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 14:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 15: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 15:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 18: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 18:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 19: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 19:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 20: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 20:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 21: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 21:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 22: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 22:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 23: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 23:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 16: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s2b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 16:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 1: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 1:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 4: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 4:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 7: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 7:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 8: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 8:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 11: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 11:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 2: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 2:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 3: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 3:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 5: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 5:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 6: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 6:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 9: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 9:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 10: /lus/flare/projects/Aurora_deployment/pkourdis/conda/envs/pytorch-2.7+git7bab735/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:1525: UserWarning: Set timeout is now only supported for either nccl or gloo.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 10:   warnings.warn("Set timeout is now only supported for either nccl or gloo.")
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:47:47,601 - root - INFO - [31mstep: 10  [32mloss:  9.8036  [33mmemory: 57.49GiB(89.82%)  [34mtps: 373  [36mtflops: 21.60  [35mmfu: 6.92%[39m
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:51:26,878 - root - INFO - [31mstep: 20  [32mloss:  8.4453  [33mmemory: 57.49GiB(89.82%)  [34mtps: 374  [36mtflops: 21.64  [35mmfu: 6.93%[39m
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:55:06,185 - root - INFO - [31mstep: 30  [32mloss:  7.6182  [33mmemory: 57.49GiB(89.82%)  [34mtps: 374  [36mtflops: 21.63  [35mmfu: 6.93%[39m
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 16:58:45,601 - root - INFO - [31mstep: 40  [32mloss:  7.1763  [33mmemory: 57.49GiB(89.82%)  [34mtps: 373  [36mtflops: 21.62  [35mmfu: 6.93%[39m
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 17:02:03,192 - root - INFO - [GC] Peforming periodical GC collection. 0.07 seconds.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 17:02:25,125 - root - INFO - [31mstep: 50  [32mloss:  7.1274  [33mmemory: 57.49GiB(89.82%)  [34mtps: 373  [36mtflops: 21.61  [35mmfu: 6.93%[39m
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 17:06:04,775 - root - INFO - [31mstep: 60  [32mloss:  6.8715  [33mmemory: 57.49GiB(89.82%)  [34mtps: 373  [36mtflops: 21.60  [35mmfu: 6.92%[39m
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 17:09:44,267 - root - INFO - [31mstep: 70  [32mloss:  6.6102  [33mmemory: 57.49GiB(89.82%)  [34mtps: 373  [36mtflops: 21.62  [35mmfu: 6.93%[39m
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 17:13:23,851 - root - INFO - [31mstep: 80  [32mloss:  6.6109  [33mmemory: 57.49GiB(89.82%)  [34mtps: 373  [36mtflops: 21.61  [35mmfu: 6.93%[39m
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 17:17:03,314 - root - INFO - [31mstep: 90  [32mloss:  6.4696  [33mmemory: 57.49GiB(89.82%)  [34mtps: 373  [36mtflops: 21.62  [35mmfu: 6.93%[39m
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 17:20:20,915 - root - INFO - [GC] Peforming periodical GC collection. 0.07 seconds.
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 17:20:42,821 - root - INFO - [31mstep: 100  [32mloss:  6.3559  [33mmemory: 57.49GiB(89.82%)  [34mtps: 373  [36mtflops: 21.61  [35mmfu: 6.93%[39m
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 17:24:22,435 - root - INFO - [31mstep: 110  [32mloss:  6.2833  [33mmemory: 57.49GiB(89.82%)  [34mtps: 373  [36mtflops: 21.60  [35mmfu: 6.92%[39m
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 17:28:01,880 - root - INFO - [31mstep: 120  [32mloss:  6.2480  [33mmemory: 57.49GiB(89.82%)  [34mtps: 373  [36mtflops: 21.62  [35mmfu: 6.93%[39m
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 17:31:41,399 - root - INFO - [31mstep: 130  [32mloss:  6.0900  [33mmemory: 57.49GiB(89.82%)  [34mtps: 373  [36mtflops: 21.61  [35mmfu: 6.93%[39m
x4716c7s0b0n0.hostmgmt2716.cm.aurora.alcf.anl.gov 0: [titan] 2025-03-19 17:35:20,561 - root - INFO - [31mstep: 140  [32mloss:  6.1389  [33mmemory: 57.49GiB(89.82%)  [34mtps: 374  [36mtflops: 21.65  [35mmfu: 6.94%[39m
